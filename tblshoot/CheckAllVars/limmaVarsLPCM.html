<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="generator" content="pandoc" />

    <meta name="author" content="Lindsay Rutter" />
  
  
  <title>Limma Extraneous variables with LPCM</title>

    <script src="limmaVarsLPCM_files/jquery-1.11.3/jquery.min.js"></script>
  <link href="limmaVarsLPCM_files/bootstrap-3.3.2/css/bootstrap.min.css" rel="stylesheet" />
  <script src="limmaVarsLPCM_files/bootstrap-3.3.2/js/bootstrap.min.js"></script>
  <script src="limmaVarsLPCM_files/bootstrap-3.3.2/shim/html5shiv.min.js"></script>
  <script src="limmaVarsLPCM_files/bootstrap-3.3.2/shim/respond.min.js"></script>
  <link href="limmaVarsLPCM_files/highlight-8.4/tomorrow.css" rel="stylesheet" />
  <script src="limmaVarsLPCM_files/highlight-8.4/highlight.pack.js"></script>
  <link href="limmaVarsLPCM_files/fontawesome-4.3.0/css/font-awesome.min.css" rel="stylesheet" />
  <script src="limmaVarsLPCM_files/stickykit-1.1.1/sticky-kit.min.js"></script>
  <script src="limmaVarsLPCM_files/jqueryeasing-1.3/jquery.easing.min.js"></script>
  <link href="limmaVarsLPCM_files/recliner-0.2.2/recliner.css" rel="stylesheet" />
  <script src="limmaVarsLPCM_files/recliner-0.2.2/recliner.min.js"></script>
  <script src="limmaVarsLPCM_files/recliner-0.2.2/onload.js"></script>
  <link href="limmaVarsLPCM_files/packagedocs-0.0.1/pd.css" rel="stylesheet" />
  <script src="limmaVarsLPCM_files/packagedocs-0.0.1/pd.js"></script>
  <script src="limmaVarsLPCM_files/packagedocs-0.0.1/pd-sticky-toc.js"></script>
  
  
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>

  
  <header class="navbar navbar-white navbar-fixed-top" role="banner" id="header">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
                <a href="index.html" class="navbar-brand page-scroll">
        Limma Extraneous variables with LPCM
        </a>
      </div>
          </div>
  </header>

  <!-- Begin Body -->
  <div class="container">
    <div class="row">
            <div class="col-md-12">
      
<div id="content-top"></div>
<p><meta http-equiv="content-type" content="text/html;charset=utf-8" /></p>
<p>Try new paper (<a href="https://www.bioconductor.org/help/workflows/RNAseq123/" class="uri">https://www.bioconductor.org/help/workflows/RNAseq123/</a>)</p>
<pre class="r"><code>library(limma)
library(Glimma)
library(GGally)
library(ggplot2)
library(edgeR)
library(DESeq2)

rm(list=ls())
thisPath &lt;- &quot;/Users/lindz/bigPint&quot;
beeCounts &lt;- read.delim(file=paste0(thisPath, &quot;/AllLaneCount.txt&quot;), row.names=1, stringsAsFactors = FALSE)
colnames(beeCounts) &lt;- c(&quot;NC.1&quot;, &quot;NC.2&quot;, &quot;NR.1&quot;, &quot;VR.1&quot;, &quot;NS.1&quot;, &quot;VP.1&quot;, &quot;NS.2&quot;, &quot;VR.2&quot;, &quot;NP.1&quot;, &quot;VP.2&quot;, &quot;VC.1&quot;, &quot;NP.2&quot;, &quot;VP.3&quot;, &quot;NP.3&quot;, &quot;VS.1&quot;, &quot;VS.2&quot;, &quot;VC.2&quot;, &quot;NC.3&quot;, &quot;VP.4&quot;, &quot;NC.4&quot;, &quot;NR.2&quot;, &quot;VC.3&quot;, &quot;VC.4&quot;, &quot;NP.4&quot;, &quot;VR.3&quot;, &quot;NC.5&quot;, &quot;VS.3&quot;, &quot;NP.5&quot;, &quot;VC.5&quot;, &quot;VS.4&quot;, &quot;NS.3&quot;, &quot;VS.5&quot;, &quot;VP.5&quot;, &quot;NR.3&quot;, &quot;NR.4&quot;, &quot;VC.6&quot;, &quot;NS.4&quot;, &quot;NC.6&quot;, &quot;NP.6&quot;, &quot;VR.4&quot;, &quot;NR.5&quot;, &quot;NR.6&quot;, &quot;NS.5&quot;, &quot;VP.6&quot;, &quot;NS.6&quot;, &quot;VR.5&quot;, &quot;VR.6&quot;, &quot;VS.6&quot;)
beeCounts &lt;- beeCounts[ , order(names(beeCounts))]
x &lt;- DGEList(counts=beeCounts)

exVars &lt;- read.csv(&quot;/Users/lindz/bigPint/tblshoot/CheckAllVars/extraVarClean.csv&quot;)

x$samples$group &lt;- as.factor(unlist(lapply(colnames(x), function(x) substring(unlist(strsplit(x, &quot;[.]&quot;))[1],1))))
x$samples$virus &lt;- as.factor(unlist(lapply(colnames(x), function(x) substring(unlist(strsplit(x, &quot;[.]&quot;))[1],1,1))))
x$samples$diet &lt;- as.factor(unlist(lapply(colnames(x), function(x) substring(unlist(strsplit(x, &quot;[.]&quot;))[1],2,2))))
x$samples$lane &lt;- exVars$Lane
x$samples$day &lt;- exVars$Day
x$samples$mortality &lt;- exVars$Mortality
x$samples$sbv &lt;- exVars$SBV
x$samples$iapv &lt;- exVars$IAPV
x$samples$rnaConc &lt;- exVars$rnaConc
x$samples$rin &lt;- exVars$RIN</code></pre>
<p>Make quantitative extraneous variables categorical</p>
<pre class="r"><code>x$samples$day &lt;- as.factor(x$samples$day)
x$samples$mortality &lt;- cut(x$samples$mortality,3,labels=c(&#39;Low&#39;,&#39;Medium&#39;,&#39;High&#39;))
x$samples$sbv &lt;- cut(x$samples$sbv,3,labels=c(&#39;Low&#39;,&#39;Medium&#39;,&#39;High&#39;))
x$samples$iapv &lt;- cut(x$samples$iapv,3,labels=c(&#39;Low&#39;,&#39;Medium&#39;,&#39;High&#39;))
x$samples$rnaConc &lt;- cut(x$samples$rnaConc,3,labels=c(&#39;Low&#39;,&#39;Medium&#39;,&#39;High&#39;))
x$samples$rin &lt;- cut(x$samples$rin,3,labels=c(&#39;Low&#39;,&#39;Medium&#39;,&#39;High&#39;))</code></pre>
<p>Filter then normalize</p>
<pre class="r"><code># rule of thumb is to keep rows that have at least 10 counts for several samples
keep.exprs &lt;- which(rowSums(x[[1]]&gt;10)&gt;8)
x &lt;- x[keep.exprs,, keep.lib.sizes=FALSE] # 15,314 to 10,221
x &lt;- calcNormFactors(x, method = &quot;TMM&quot;)
lcpm &lt;- cpm(x, log=TRUE)</code></pre>
<p>Make boxplot</p>
<pre class="r"><code>ggparcoord(data.frame(lcpm), columns=1:48, alphaLines=0, boxplot=TRUE, scale=&quot;globalminmax&quot;) + coord_flip()</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-4-1.png" width="960" /></p>
<p>Create MDS plots</p>
<pre class="r"><code>library(RColorBrewer)
col.group &lt;- x$samples$group
levels(col.group) &lt;- brewer.pal(nlevels(col.group), &quot;Set1&quot;)
col.group &lt;- as.character(col.group)

col.virus &lt;- x$samples$virus
levels(col.virus) &lt;-  brewer.pal(nlevels(col.virus), &quot;Set2&quot;)</code></pre>
<pre><code>Warning in brewer.pal(nlevels(col.virus), &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<pre class="r"><code>col.virus &lt;- as.character(col.virus)

col.diet &lt;- x$samples$diet
levels(col.diet) &lt;-  brewer.pal(nlevels(col.diet), &quot;Set3&quot;)
col.diet &lt;- as.character(col.diet)

col.lane &lt;- x$samples$lane
levels(col.lane) &lt;-  brewer.pal(nlevels(col.lane), &quot;Set1&quot;)</code></pre>
<pre><code>Warning in brewer.pal(nlevels(col.lane), &quot;Set1&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<pre class="r"><code>col.lane &lt;- as.character(col.lane)

col.day &lt;- x$samples$day
levels(col.day) &lt;-  brewer.pal(nlevels(col.day), &quot;Set2&quot;)</code></pre>
<pre><code>Warning in brewer.pal(nlevels(col.day), &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<pre class="r"><code>col.day &lt;- as.character(col.day)

col.mortality &lt;- x$samples$mortality
levels(col.mortality) &lt;-  brewer.pal(nlevels(col.mortality), &quot;Set3&quot;)
col.mortality &lt;- as.character(col.mortality)

col.sbv &lt;- x$samples$sbv
levels(col.sbv) &lt;-  brewer.pal(nlevels(col.sbv), &quot;Set1&quot;)
col.sbv &lt;- as.character(col.sbv)

col.iapv &lt;- x$samples$iapv
levels(col.iapv) &lt;-  brewer.pal(nlevels(col.iapv), &quot;Set2&quot;)
col.iapv &lt;- as.character(col.iapv)

col.rnaConc &lt;- x$samples$rnaConc
levels(col.rnaConc) &lt;-  brewer.pal(nlevels(col.rnaConc), &quot;Set3&quot;)
col.rnaConc &lt;- as.character(col.rnaConc)

col.rin &lt;- x$samples$rin
levels(col.rin) &lt;-  brewer.pal(nlevels(col.rin), &quot;Set1&quot;)
col.rin &lt;- as.character(col.rin)</code></pre>
<p>Group LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.group)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
<p>Virus LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.virus)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
<p>Diet LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.diet)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-8-1.png" width="960" /></p>
<p>Lane LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.lane)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-9-1.png" width="960" /></p>
<p>Day LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.day)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<p>Mortality LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.mortality)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
<p>SBV LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.sbv)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-12-1.png" width="960" /></p>
<p>IAPV LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.iapv)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-13-1.png" width="960" /></p>
<p>RNAConc LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.rnaConc)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-14-1.png" width="960" /></p>
<p>RIN LCPM</p>
<pre class="r"><code>plotMDS(lcpm, labels=colnames(lcpm), col=col.rin)</code></pre>
<p><img src="limmaVarsLPCM_files/figure-html/unnamed-chunk-15-1.png" width="960" /></p>
<p>Make interactive plots for all variables in LCPM</p>
<pre class="r"><code>glMDSPlot(lcpm, labels=paste(x$samples$group, x$samples$virus, x$samples$diet, x$samples$lane, x$samples$day, x$samples$mortality, x$samples$sbv, x$samples$iapv, x$samples$rnaConc, x$samples$rin, colnames(lcpm), sep=&quot;_&quot;), groups=x$samples[,c(1,c(4:12))], launch=FALSE, folder = &quot;glimmaPlotsLPCM&quot;, html = &quot;glimmaPlotsLPCM&quot;)</code></pre>


      </div>
    </div>
  </div>

  <div id="footer">
    <div class="container">
      <div class="col-md-6">
              </div>
      <div class="col-md-6">
        <p class="pull-right">created with <a href="https://github.com/hafen/packagedocs">packagedocs</a>
                  </p>
      </div>
    </div>
  </div>

  
</body>
</html>
