<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="generator" content="pandoc" />

    <meta name="author" content="Lindsay Rutter" />
  
  
  <title>Honey Bees - edgeR</title>

    <script src="fnScript_files/jquery-1.11.3/jquery.min.js"></script>
  <link href="fnScript_files/bootstrap-3.3.2/css/bootstrap.min.css" rel="stylesheet" />
  <script src="fnScript_files/bootstrap-3.3.2/js/bootstrap.min.js"></script>
  <script src="fnScript_files/bootstrap-3.3.2/shim/html5shiv.min.js"></script>
  <script src="fnScript_files/bootstrap-3.3.2/shim/respond.min.js"></script>
  <link href="fnScript_files/highlight-8.4/tomorrow.css" rel="stylesheet" />
  <script src="fnScript_files/highlight-8.4/highlight.pack.js"></script>
  <link href="fnScript_files/fontawesome-4.3.0/css/font-awesome.min.css" rel="stylesheet" />
  <script src="fnScript_files/stickykit-1.1.1/sticky-kit.min.js"></script>
  <script src="fnScript_files/jqueryeasing-1.3/jquery.easing.min.js"></script>
  <link href="fnScript_files/recliner-0.2.2/recliner.css" rel="stylesheet" />
  <script src="fnScript_files/recliner-0.2.2/recliner.min.js"></script>
  <script src="fnScript_files/recliner-0.2.2/onload.js"></script>
  <link href="fnScript_files/packagedocs-0.0.1/pd.css" rel="stylesheet" />
  <script src="fnScript_files/packagedocs-0.0.1/pd.js"></script>
  <script src="fnScript_files/packagedocs-0.0.1/pd-collapse-toc.js"></script>
  
  
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>

  
  <header class="navbar navbar-white navbar-fixed-top" role="banner" id="header">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
                <a href="index.html" class="navbar-brand page-scroll">
        Honey Bees - edgeR
        </a>
      </div>
          </div>
  </header>

  <!-- Begin Body -->
  <div class="container">
    <div class="row">
            <div class="col-md-12">
      
<div id="content-top"></div>
<p><meta http-equiv="content-type" content="text/html;charset=utf-8" /></p>
<pre class="r"><code>library(edgeR)
library(ggplot2)
library(GGally)
library(EDASeq)
library(utils)

beeCounts &lt;-read.delim(file=&quot;../AllLaneCount.txt&quot;,row.names=1,stringsAsFactors = FALSE)

colnames(beeCounts) &lt;- c(&quot;NC.1&quot;, &quot;NC.2&quot;, &quot;NR.1&quot;, &quot;VR.1&quot;, &quot;NN.1&quot;, &quot;VP.1&quot;, &quot;NN.2&quot;, &quot;VR.2&quot;, &quot;NP.1&quot;, &quot;VP.2&quot;, &quot;VC.1&quot;, &quot;NP.2&quot;, &quot;VP.3&quot;, &quot;NP.3&quot;, &quot;VN.1&quot;, &quot;VN.2&quot;, &quot;VC.2&quot;, &quot;NC.3&quot;, &quot;VP.4&quot;, &quot;NC.4&quot;, &quot;NR.2&quot;, &quot;VC.3&quot;, &quot;VC.4&quot;, &quot;NP.4&quot;, &quot;VR.3&quot;, &quot;NC.5&quot;, &quot;VN.3&quot;, &quot;NP.5&quot;, &quot;VC.5&quot;, &quot;VN.4&quot;, &quot;NN.3&quot;, &quot;VN.5&quot;, &quot;VP.5&quot;, &quot;NR.3&quot;, &quot;NR.4&quot;, &quot;VC.6&quot;, &quot;NN.4&quot;, &quot;NC.6&quot;, &quot;NP.6&quot;, &quot;VR.4&quot;, &quot;NR.5&quot;, &quot;NR.6&quot;, &quot;NN.5&quot;, &quot;VP.6&quot;, &quot;NN.6&quot;, &quot;VR.5&quot;, &quot;VR.6&quot;, &quot;VN.6&quot;)

beeCounts &lt;- beeCounts[ , order(names(beeCounts))]

y &lt;- DGEList(counts=beeCounts)</code></pre>
<p>edgeR vignette states that a gene is required to have a count of 5-10 in a library to be considered expressed in that library. Here minLib is equal to 3.04425910^{6}. A CPM of 3 corresponds to a count of ~9 in the minimum number of samples in a group (24). So, I keep only rows that have that. This reduces the number of genes from 15,314 to 8,581.</p>
<pre class="r"><code>minLib &lt;- min(y$samples$lib.size)
keep &lt;- rowSums(cpm(y)&gt;3) &gt;= 24
# Number of genes 15,314--&gt; 8,581
y &lt;- y[keep, , keep.lib.sizes=FALSE]</code></pre>
<p>Next, I used edgeR normalization.</p>
<pre class="r"><code>yERN &lt;- calcNormFactors(y)</code></pre>
<p>The boxplot has many outliers, and I cannot see any boxes.</p>
<pre class="r"><code>ggparcoord(data.frame(yERN[[1]]), columns=1:48, alphaLines=0, boxplot=TRUE, scale=&quot;globalminmax&quot;) + coord_flip()</code></pre>
<p><img src="fnScript_files/figure-html/unnamed-chunk-4-1.png" width="624" /></p>
<p>I can create MDS plots of interest.</p>
<pre class="r"><code>allGroups &lt;- c(rep(&quot;NC&quot;,6), rep(&quot;NN&quot;,6), rep(&quot;NP&quot;,6), rep(&quot;NR&quot;,6), rep(&quot;VC&quot;,6), rep(&quot;VN&quot;,6), rep(&quot;VP&quot;,6), rep(&quot;VR&quot;,6))
yERN$samples$group &lt;- allGroups
plotMDS(y, col = c(&quot;red&quot;,&quot;deeppink&quot;,&quot;darkorange&quot;,&quot;gold&quot;,&quot;green2&quot;, &quot;green4&quot;,&quot;blue&quot;, &quot;purple&quot;)[factor(allGroups)], cex=0.6)</code></pre>
<p><img src="fnScript_files/figure-html/unnamed-chunk-5-1.png" width="624" /></p>
<pre class="r"><code>plotMDS(y, col = c(&quot;blue&quot;,&quot;blue&quot;,&quot;blue&quot;,&quot;blue&quot;,&quot;red&quot;,&quot;red&quot;,&quot;red&quot;,&quot;red&quot;)[factor(allGroups)], cex=0.6)</code></pre>
<p><img src="fnScript_files/figure-html/unnamed-chunk-5-2.png" width="624" /></p>
<pre class="r"><code>plotMDS(y, col = c(&quot;white&quot;,&quot;red&quot;,&quot;blue&quot;,&quot;white&quot;,&quot;white&quot;,&quot;white&quot;,&quot;white&quot;,&quot;white&quot;)[factor(allGroups)], cex=0.6)</code></pre>
<p><img src="fnScript_files/figure-html/unnamed-chunk-5-3.png" width="624" /></p>
<pre class="r"><code>plotMDS(y, col = c(&quot;white&quot;,&quot;white&quot;,&quot;white&quot;,&quot;white&quot;,&quot;white&quot;,&quot;red&quot;,&quot;blue&quot;,&quot;white&quot;)[factor(allGroups)], cex=0.6)</code></pre>
<p><img src="fnScript_files/figure-html/unnamed-chunk-5-4.png" width="624" /></p>
<pre class="r"><code>plotMDS(y, col = c(&quot;white&quot;,&quot;white&quot;,&quot;blue&quot;,&quot;white&quot;,&quot;white&quot;,&quot;red&quot;,&quot;white&quot;,&quot;white&quot;)[factor(allGroups)], cex=0.6)</code></pre>
<p><img src="fnScript_files/figure-html/unnamed-chunk-5-5.png" width="624" /></p>


      </div>
    </div>
  </div>

  <div id="footer">
    <div class="container">
      <div class="col-md-6">
              </div>
      <div class="col-md-6">
        <p class="pull-right">created with <a href="https://github.com/hafen/packagedocs">packagedocs</a>
                  </p>
      </div>
    </div>
  </div>

  
</body>
</html>
